<!doctype html>
<html>
<head>
  <title>Matt's Finance Planner</title>
  <script type="text/javascript" src="jquery1.7.2.js"></script>
  <script type="text/javascript" src="finance.js"></script>
  <link rel="stylesheet" type="text/css" href="finance.css" />
</head>

 <body>

 <div id="choose">
  <select id="cashflows">
  </select>

  name:<input id="cashflowname"></input>
  <button id="newcashflow">Create new</button>
 </div>

 <div id="current">
  <table id="pertrans" border="2">

   <tr>
    <th>Action</th>
    <th>Amount</th>
    <th>Description</th>
    <th>Period</th>
    <th>Debit/credit</th>
   </tr>

   <tr id="newrow">
    <td><button>Create new</button></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
   </tr>

  </table>
 </div>

 <div id="calculations">
   total for year: <span id="result">0</span>
 </div>

 <script type="text/javascript">

 $(document).ready(function() {

  var analysis = new Analysis();
  var cfview = new CashFlow(analysis);
  var gview = new GridView();
  var aview = new AnalyzeView();

  $("#newcashflow").click(function() {
    // create new CashFlow, add to analysis
    //   add to #cashflow ... should be listening to analysis
    //   don't switch to it unless it's the first one .... but maybe should just start out with empty one?
    an.addCashFlow(new CashFlow($("#cashflowname").val()));
    alert("unimplemented");
  });

  $("#cashflow").change(function() {
    var cfname = $("#cashflow").val();     // currently selected ... should this make a call to cfview instead of using jQuery?
    var cf = analysis.getCashFlow(cfname); // use it to look up the CashFlow
    gview.setCashFlow(cf);                 // ... these could also be implemented using listeners instead ...
    aview.setCashFlow(cf);
  });

  $("#newrow").click(function() {
    try {
      var ptran = new PerTran(0, "", "month", "debit");
      var id = cf.addPerTran(ptran);
      makeRow(id, ptran);
    } catch(e) {
      alert(e);
    }
  });

 });

 </script>
  
 </body>
</html>